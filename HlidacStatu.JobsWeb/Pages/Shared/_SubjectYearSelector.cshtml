@using HlidacStatu.JobsWeb.Services

@{
    var obory = JobService.DistinctJobs
        .GroupBy(x => x.Subject)
        .ToDictionary(k => k.Key, v => v.Select(x => x.Year).Distinct().ToList());

    obory["IT"].Add(2021);
    obory["IT"].Add(2022);


}

<form>
    <div class="row">
        <div class="col-auto">
            <label class="col-form-label">Vyberte obor a rok</label>
        </div>
        
        <div class="col-auto">
            <select class="form-select" name="obor" id="obor_selector">
                <option disabled selected> -- vyberte obor -- </option>
                @foreach (var obor in obory)
                {
                    <option value="@obor.Key" data-years="@string.Join(';', obor.Value)">@obor.Key</option>
                }
            </select>
        </div>

        <div class="col-auto">
            <select class="form-select" name="rok" id="year_selecor">
                <option disabled selected> -- vyberte rok -- </option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary btn-sm col-auto">Potvrdit</button>
    </div>
</form>

<script>
$('#obor_selector').change(function() {
    var element = $(this).find('option:selected');
    var years = element.data("years"); 
    
    $('#year_selecor').empty()
        .append('<option disabled selected> -- vyberte rok -- </option>');
    
    years.split(';').forEach(y => {
        $('#year_selecor')
            .append('<option value="' + y + '">' + y + '</option>')
    });
            
});
</script>